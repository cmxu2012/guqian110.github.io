Title: 数字信号处理和相关matlab函数总结
Date: 2014-09-03 23:16
Category: Telecom
Tags: Telecom, digital procesing, matlab
Slug: digital_signal_processing_and_matlab
Author: Qian Gu
Summary: 总结信号处理和matlab相关应用

学了这么多年的通信，却还是对信号处理的知识一知半解，应付考试还可以，但在实际应用中还是感到力不从心，很多知识都忘了。翻了一下午的 《信号与系统》、《数字信号处理》，简单总结一下。

《信号与系统》算是通信专业最基础的专业课了。

信号部分主要介绍信号的相关定义、分类、常用信号和三大变换：傅立叶变换、拉普拉斯变换和z 变换。

系统部分主要从时域和频域使用不同的方法分析线性时不变系统（LTI）的性质。

《数字信号处理》算是前一门课的深入，现在利用计算机处理信号，首先就是要将模拟信号数字化，然后进行处理。这门课也就是讲相关的知识。

一般教材就讲两大部分：第一部分首先承接《信号与系统》，时域的连续信号要在计算机中处理就必须采样，变为时域离散信号，这部分就讲离散时间信号的处理，比如 z 变换 和离散傅立叶变换。第二部分讲数字滤波器的设计，包括 FIR 和 IIR 两种。

<br>

## Signal Processing
* * *

*这部分是我串联的这两本书中很小的一部分知识，算是一个备忘的笔记吧，作为一名学渣，一个月不看也会忘记不少 =.=*

*从 《信号与系统》 中我们可以知道：*

**周期信号 （连续）傅立叶级数 （CFS）**

首先，由高数知识可以知道：只要满足 Dirichlet 条件，周期信号就可以进行傅立叶级数分解，可以得到幅度频谱和相位频谱。

时域信号是周期的、连续的，频域信号是离散的。

**非周期信号 （连续）傅立叶变换 （CFT)**

周期信号的周期无限增大，就可以将周期信号转化为非周期信号，从而得到非周期信号的傅立叶变换。

得到的频率域的结果为连续信号，计算结果为时域信号的频谱密度函数，简称频谱函数。

**周期信号 （连续）傅立叶变换 （CFT)**

对于周期信号，因为它不满足绝对可积的条件，所以从非周期信号无法直接推广。但是借助 *奇异函数*（如冲激函数）的概念，可以使许多不满足绝对可积的信号（如周期信号）存在傅立叶变换。

周期信号的傅立叶变换结果由一些冲激函数组成，冲激函数的强度是对应的傅立叶级数的 2pi 倍，频谱是离散的。

这样，周期信号和非周期信号的傅立叶分析得到了统一。

*接下来，就要进入《数字信号处理》部分了：*

**离散时间信号傅立叶变换 （DTFT)**

时域连续信号经过采样，得到离散时间信号，对于离散时间信号，可以从 z 变换中引出 DTFT 的定义。

DTFT 是一种特殊的傅立叶变换（FT），它满足所有的傅立叶变换的性质。

**离散傅立叶变换 （DFT）**

虽然 DTFT 解决了信号在时域的连续问题，但是变换结果仍然是连续信号，也就是说在频域仍然是连续的，这样计算机仍然是无法处理的。所以，就引出了离散傅立叶级数（DFS)和离散傅立叶变换（DFT）。

时域信号的周期性对应着频域的离散化，而且时域信号的离散化对应着频域的周期性。由这两点，可以知道周期的离散信号具有离散的、周期的频谱，也就是离散傅立叶级数（DFS）。

把时域和频域的数据长度都限定在主周期，那么就得到了标准的离散傅立叶变换（DFT）。

经过分析，可以知道，DFT 是 z 变换的取样，也是 DTFT 的取样结果。

DFT 因为是离散的，长度有限，所以很适合计算机计算，而且人们发明了高效地计算 DFT 的方法 —— FFT 。

知乎上还有一篇专栏的文章，得到了非常多人的赞同，可以进一步参考。

[傅里叶分析之掐死教程（完整版）更新于2014.06.06](http://zhuanlan.zhihu.com/wille/19763358)

<br>

## Matlab
* * *

### basic 
分析各种变化，可以得到以下的关系：

N 点的 DFT（FFT），其结果对应的

数字角频率 w 为 [0, 2pi)

模拟角频率 Ω 为 [0, Ωs)

模拟频率 f 为 [0, fs)

所以对于 N 点 FFT 的结果，对应的横坐标频率的范围为 [0, fs)。

matlab 提供了函数 fft 和 fftshift 直接完成变换。

### adv

假设我们的采样频率为 Fs （采样周期为 T = 1/Fs），一共采了 N 个点，那么相当于对信号进行了截断，截断长度为 `L = N * T` 秒。

这 3 个参数就决定了我们的最终结果。

在非周期信号处理中存在下面的 3 个问题：

+ 频谱混叠。如果信号不是带限的，那么为了减小频谱混叠的影响，我们应该尽可能提高采样频率，也就是减小采样周期 T

+ 频率分辨率和栅栏效应。因为 DFT 是 DTFT 的等间隔采样，那么 N 越大，采样点数越多，栅栏就越小，频率分辨率 `f0 = Fs/N` 就越高。

+ 截断效应和频谱泄漏。如果信号是无限长的，那么必须把它截断到长度 `L = N*T`。截断会带来吉布斯效应，并且引入窗函数的频谱，造成频谱泄漏。

根据上面的分析，为了减少混叠，必须使 T 足够小；而为了提高分辨率，N 应该足够大。但是太小的 T 和太大的 N 也没有必要，所以应该合理选择。

**一般应该先选择 L 使得信号的绝大部分都在窗内，其次，根据分辨率的要求选择 T 和 N。**

举例说明：

**非周期信号**

比如矩形脉冲信号，宽度为 [-tau/2, tau/2]，对应的频谱为 Sa 函数，零点为 1/tau，2/tau，3/tau ...

假设 tau = 1，采样频率 Fs = 10 Hz，那么如果要求频率分辨率为 f0 = Fs/N = 1/40 Hz 的话，可以推出 N = 390。所以时域采样结果应该是 195 个 0，之后是 10 个 1，最后是 195 个 0。

    #!matlab
    x = [zeros(1,195), ones(1,10), zeros(1,195)];
    y = fft(x);
    y = fftshift(y);
    mag = abs(y);
    Fs = 10;
    f = [-Fs/2 : 1/40 : Fs/2-1/40];
    plot(f,mag,'*');
        
结果如下图所示，与预期是相符合的，1/tau 的整数倍处都是过零点。

![sa](/images/digital_signal_processing_and_matlab/sa.png)

**周期信号**

比如 s(t) = 1 + 0.5cos(2*pi*15*t) + 2sin(2*pi*40*t);

最大的频率分量为 fmax =  40 Hz，如果采用频率为 10 倍，即 Fs = 400 Hz，如果要求频率分辨率为 0.5 Hz，那么可以得到 N = 800，为了计算方便使用 N = 1024；

    #!matlab
    f1 = 15;
    f2 = 40;
    % sample frequency is 400 Hz, sample number is 1024
    Fs = 400;
    N = 1024;
    n = [0:N-1];
    t = n/Fs;
    x = 1 + 0.5*cos(2*pi*f1*t) + 2*sin(2*pi*f2*t);
    y = fft(x); % fft operation
    y = fftshift(y);
    mag = abs(y); % magnitude
    f0 = Fs/N;
    f = [-Fs/2 : f0 : Fs/2 - f0];
    % plot time domain singal
    subplot(2,1,1);
    plot(x);
    xlabel('time/s');
    ylabel('magnitude');
    title('time domain signal');
    grid on;
    % plot frequency domain signal
    subplot(2,1,2);
    plot(f,mag);
    title('fft result');
    grid on;


结果如下图所示，可以看到与预期相符，在 0、15、40 处有冲激函数。

![periodic](/images/digital_signal_processing_and_matlab/periodic.png)

<br>

## Reference

[信号与系统引论](http://book.douban.com/subject/3712794/)

[数字信号处理](http://book.douban.com/subject/4025528/)

[数字信号处理教程——MATLAB释义与实现](http://book.douban.com/subject/24868505/)
